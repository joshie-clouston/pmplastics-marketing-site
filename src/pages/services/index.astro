---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import ContentCard from '../../components/ui/ContentCard.astro';
import SecondaryCTA from '../../components/sections/SecondaryCTA.astro';
import BreadcrumbSchema from '../../components/schema/BreadcrumbSchema.astro';
import ItemListSchema from '../../components/schema/ItemListSchema.astro';
import { resolveImage } from '../../lib/images';

export const prerender = true;

const services = (await getCollection('services', ({ data }) => !data.draft))
  .sort((a, b) => a.data.order - b.data.order);
---
<BaseLayout title="Services" description="Full-service plastic fabrication — CNC cutting, laser engraving, vacuum forming, thermo forming, and more. P&M Plastics, Gold Coast.">
  <BreadcrumbSchema items={[{ name: 'Services', href: '/services' }]} slot="structured-data" />
  <ItemListSchema name="Plastic Fabrication Services" description="Full-service plastic fabrication capabilities from P&M Plastics" items={services.map((s) => ({ name: s.data.title, url: `/services/${s.id}` }))} slot="structured-data" />

  <section class="section bg-secondary text-secondary-foreground">
    <div class="container mx-auto text-center">
      <h1 class="text-4xl sm:text-5xl font-900 tracking-tight mb-4" data-animate="fade-up">Our Services</h1>
      <p class="text-lg text-gray-400 max-w-2xl mx-auto" data-animate="fade-up">
        Advanced CNC equipment, 30 years of expertise, and a full range of plastic fabrication capabilities — all under one roof.
      </p>
    </div>
  </section>

  <section class="section bg-white">
    <div class="container mx-auto">
      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6" data-animate="stagger">
        {services.map((service) => (
          <ContentCard
            href={`/services/${service.id}`}
            title={service.data.title}
            description={service.data.description}
            image={service.data.image ? resolveImage(service.data.image) : undefined}
          />
        ))}
      </div>
    </div>
  </section>

  <SecondaryCTA
    heading="Need something custom?"
    description="Whatever the material, whatever the shape — we can fabricate it. Tell us about your project."
  />
</BaseLayout>
