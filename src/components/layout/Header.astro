---
import { Image } from 'astro:assets';
import logo from '../../assets/images/logos/pm-plastics-logo-alt.png';

const navLinks = [
  { label: 'Services', href: '/services' },
  { label: 'Products', href: '/products' },
  { label: 'Materials', href: '/materials' },
  { label: 'Industries', href: '/industries' },
  { label: 'Gallery', href: '/gallery' },
  { label: 'About', href: '/about' },
  { label: 'Contact', href: '/contact' },
];

const currentPath = Astro.url.pathname;
---
<header class="sticky top-0 z-50 bg-white/95 backdrop-blur-sm border-b border-border">
  <div class="container mx-auto px-4 sm:px-6">
    <div class="flex items-center justify-between h-16 lg:h-20">
      <!-- Logo -->
      <a href="/" class="flex-shrink-0">
        <Image src={logo} alt="P&M Plastics" width={140} height={50} class="h-10 lg:h-12 w-auto" />
      </a>

      <!-- Desktop nav -->
      <nav class="hidden lg:flex items-center gap-1">
        {navLinks.map((link) => (
          <a
            href={link.href}
            class:list={[
              'px-3 py-2 text-sm font-medium rounded-md transition-colors',
              currentPath.startsWith(link.href)
                ? 'text-primary bg-primary/5'
                : 'text-foreground hover:text-primary hover:bg-muted',
            ]}
          >
            {link.label}
          </a>
        ))}
      </nav>

      <!-- Desktop CTAs -->
      <div class="hidden lg:flex items-center gap-2">
        <a href="/quote" class="btn btn-outline text-sm">Get a Quote</a>
        <a href="https://perspexonline.com.au" target="_blank" rel="noopener" class="btn btn-primary text-sm">
          Buy Online
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 17L17 7"/><path d="M7 7h10v10"/></svg>
        </a>
      </div>

      <!-- Mobile hamburger -->
      <button
        id="mobile-menu-btn"
        class="lg:hidden p-2 -mr-2 text-foreground"
        aria-label="Open menu"
        aria-expanded="false"
      >
        <svg id="menu-icon-open" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
        <svg id="menu-icon-close" class="hidden" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
    </div>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden lg:hidden pb-4 border-t border-border mt-2 pt-4">
      <nav class="flex flex-col gap-1 mb-4">
        {navLinks.map((link) => (
          <a
            href={link.href}
            class:list={[
              'px-3 py-2.5 text-base font-medium rounded-md transition-colors',
              currentPath.startsWith(link.href)
                ? 'text-primary bg-primary/5'
                : 'text-foreground hover:bg-muted',
            ]}
          >
            {link.label}
          </a>
        ))}
      </nav>
      <div class="flex flex-col gap-3 pt-3 border-t border-border">
        <a href="tel:0755357544" class="text-base font-medium text-foreground px-3 py-2">
          07 5535 7544
        </a>
        <a href="/quote" class="btn btn-outline w-full text-center">Get a Quote</a>
        <a href="https://perspexonline.com.au" target="_blank" rel="noopener" class="btn btn-primary w-full text-center">
          Buy Materials Online
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 17L17 7"/><path d="M7 7h10v10"/></svg>
        </a>
      </div>
    </div>
  </div>
</header>

<script>
  function initMobileMenu() {
    const btn = document.getElementById('mobile-menu-btn');
    const menu = document.getElementById('mobile-menu');
    const iconOpen = document.getElementById('menu-icon-open');
    const iconClose = document.getElementById('menu-icon-close');

    if (!btn || !menu || !iconOpen || !iconClose) return;

    btn.addEventListener('click', () => {
      const isOpen = !menu.classList.contains('hidden');
      menu.classList.toggle('hidden');
      iconOpen.classList.toggle('hidden');
      iconClose.classList.toggle('hidden');
      btn.setAttribute('aria-expanded', String(!isOpen));
    });
  }

  document.addEventListener('astro:page-load', initMobileMenu);
  initMobileMenu();
</script>
